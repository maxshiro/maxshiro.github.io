{
    "version": "https://jsonfeed.org/version/1",
    "title": "MAXshiro • All posts by \"busybox\" tag",
    "description": "Discover and Record the world.",
    "home_page_url": "http://maxshiroi.top",
    "items": [
        {
            "id": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/215254/",
            "url": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/215254/",
            "title": "常用linux应急响应命令整理",
            "date_published": "2023-07-02T13:52:54.000Z",
            "content_html": "<h2 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h2>\n<h3 id=\"ps-auxf\"><a class=\"anchor\" href=\"#ps-auxf\">#</a> ps -auxf</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -auxf</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于显示系统中当前运行的进程。 <code>-a</code>  选项显示所有用户的进程， <code>-u</code>  选项显示进程的详细信息， <code>-x</code>  选项显示没有控制终端的进程， <code>-f</code>  选项以全格式显示进程信息。</p>\n<h3 id=\"netstat-antlp-more\"><a class=\"anchor\" href=\"#netstat-antlp-more\">#</a> netstat -antlp | more</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -antlp | more</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看系统中的网络连接和监听端口。 <code>-a</code>  选项显示所有连接和监听端口， <code>-n</code>  选项以数字形式显示地址和端口， <code>-t</code>  选项只显示 TCP 连接， <code>-l</code>  选项只显示监听端口， <code>-p</code>  选项显示与进程关联的端口， <code>| more</code>  用于分页显示输出结果。</p>\n<h3 id=\"ls-alt-procpid号\"><a class=\"anchor\" href=\"#ls-alt-procpid号\">#</a> ls -alt /proc/pid 号</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alt /proc/pid号</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定进程的详细信息。 <code>ls</code>  命令用于列出文件和目录， <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-t</code>  选项按修改时间排序， <code>/proc</code>  是一个特殊目录，包含系统中运行的进程的信息， <code>pid号</code> 是要查看的进程的进程 ID。</p>\n<h3 id=\"ls-alh-procpid\"><a class=\"anchor\" href=\"#ls-alh-procpid\">#</a> ls -alh /proc/pid</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alh /proc/pid</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定进程的详细信息。 <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-h</code>  选项以人类可读的方式显示文件大小， <code>/proc</code>  是一个特殊目录，包含系统中运行的进程的信息， <code>pid</code>  是要查看的进程的进程 ID。</p>\n<h3 id=\"lsof-i端口号-p-u\"><a class=\"anchor\" href=\"#lsof-i端口号-p-u\">#</a> lsof -i: 端口号 /-p/-u</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lsof -i:端口号 /-p /-u</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定端口的相关进程或指定用户打开的文件。 <code>lsof</code>  命令用于列出打开的文件， <code>-i:端口号</code> 选项显示指定端口相关的进程， <code>/-p</code>  选项显示指定进程打开的文件， <code>/-u</code>  选项显示指定用户打开的文件。</p>\n<h3 id=\"挖矿病毒常利用手段\"><a class=\"anchor\" href=\"#挖矿病毒常利用手段\">#</a> 挖矿病毒常利用手段</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chattr +i</span><br><span class=\"line\">lsattr</span><br></pre></td></tr></tbody></table></figure>\n<ul>\n<li>\n<p><code>chattr +i</code> ：此命令用于改变文件的属性。 <code>chattr</code>  命令用于改变文件的扩展属性， <code>+i</code>  选项设置文件为不可修改属性，防止文件被删除、重命名或修改。</p>\n</li>\n<li>\n<p><code>lsattr</code> ：此命令用于显示文件的扩展属性。 <code>lsattr</code>  命令用于</p>\n</li>\n</ul>\n<p>列出文件的扩展属性，包括文件的可修改性、不可修改性、是否加密等。</p>\n<h3 id=\"需要注意的几个目录\"><a class=\"anchor\" href=\"#需要注意的几个目录\">#</a> 需要注意的几个目录</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/passwd</span><br><span class=\"line\">/etc/rc.local</span><br><span class=\"line\">/root/.ssh</span><br><span class=\"line\">/tmp</span><br><span class=\"line\">/etc/init.d</span><br><span class=\"line\">/etc/hosts</span><br></pre></td></tr></tbody></table></figure>\n<p>此路径对应着系统启动时执行的脚本文件。 <code>/etc/rc.local</code>  文件包含在系统启动过程中自动执行的命令，可以用于配置系统启动时需要运行的自定义脚本。</p>\n<h3 id=\"ls-alt-etcprofiledsh\"><a class=\"anchor\" href=\"#ls-alt-etcprofiledsh\">#</a> ls -alt /etc/profile.d/*.sh</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alt /etc/profile.d/*.sh</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于列出 <code>/etc/profile.d/</code>  目录下以 <code>.sh</code>  为后缀的脚本文件，并按照修改时间排序显示详细信息。 <code>ls</code>  命令用于列出文件和目录， <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-t</code>  选项按修改时间排序， <code>/etc/profile.d/*.sh</code>  表示匹配 <code>/etc/profile.d/</code>  目录下以 <code>.sh</code>  为后缀的所有文件。</p>\n<h3 id=\"cat-etcpasswd-cut-f-1-d-xargs-l-crontab-l-u\"><a class=\"anchor\" href=\"#cat-etcpasswd-cut-f-1-d-xargs-l-crontab-l-u\">#</a> cat /etc/passwd | cut -f 1 -d : | xargs -l {} crontab -l -u {}</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/passwd | cut -f 1 -d : | xargs -l {} crontab -l -u {}</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看系统中所有用户的定时任务。 <code>cat</code>  命令用于显示文件内容， <code>/etc/passwd</code>  是一个包含系统用户信息的文件， <code>cut</code>  命令用于提取指定字段， <code>-f 1</code>  选项指定提取第一个字段（用户名）， <code>-d :</code>  选项指定字段的分隔符为冒号， <code>xargs</code>  命令用于将前面的输出作为参数传递给后面的命令， <code>-l</code>  选项表示逐行处理， <code>{}</code>  表示参数的占位符， <code>crontab -l -u {}</code>  用于查看指定用户的定时任务列表。</p>\n<h2 id=\"软件包校验\"><a class=\"anchor\" href=\"#软件包校验\">#</a> 软件包校验</h2>\n<ul>\n<li>\n<p><code>rpm -Va</code> ：校验 RPM 软件包的完整性和一致性。如果输出中出现以下标记，表示不一致：s (size)、m (modify)、5 (MD5)、d (device)、l (link)、u (user)、g (group)、t (time)。特别需要注意的是 SM5 标记。</p>\n</li>\n<li>\n<p><code>dpkg -verify</code> ：校验 Debian 软件包的完整性和一致性。</p>\n</li>\n</ul>\n<h2 id=\"文件操作\"><a class=\"anchor\" href=\"#文件操作\">#</a> 文件操作</h2>\n<ul>\n<li>\n<p><code>stat</code> ：显示文件或文件系统的详细信息。</p>\n</li>\n<li>\n<p><code>find / -mtime 0 -name *.*</code> ：查找指定天数内更改过的文件。</p>\n</li>\n<li>\n<p><code>find / -ctime 0 -name *.*</code> ：查找新增的文件。</p>\n</li>\n<li>\n<p><code>diff -c</code> ：比较文件的差异并生成上下文格式的差异。</p>\n</li>\n</ul>\n<h2 id=\"查找隐藏进程\"><a class=\"anchor\" href=\"#查找隐藏进程\">#</a> 查找隐藏进程</h2>\n<ul>\n<li>\n<pre><code>ps -ef | awk '{print $2}' | sort -n | uniq &gt; ps.p\nls /proc | sort -n | uniq &gt; proc.p\n</code></pre>\n<p>查找隐藏进程的命令。</p>\n</li>\n</ul>\n<h2 id=\"ssh-爆破\"><a class=\"anchor\" href=\"#ssh-爆破\">#</a> SSH 爆破</h2>\n<ul>\n<li><code>last/lastb/lastlog</code> ：查看登录记录。</li>\n</ul>\n<h2 id=\"日志\"><a class=\"anchor\" href=\"#日志\">#</a> 日志</h2>\n<ul>\n<li>\n<p><code>/var/log/secure</code> ：安全日志文件。</p>\n<ul>\n<li>\n<p><code>awk '/sshd.*Failed/{print $(NF -3)}' /var/log/secure | sort | uniq -c | sort -nr</code> ：查找每个 IP 登录失败的次数。</p>\n</li>\n<li>\n<p>每条记录的格式：时间 - 主机名 - 服务名称 - 是否成功 - 用户 - 地址</p>\n</li>\n<li>\n<p><code>sudo grep 'sshd.*Failed.*from &lt;IP_ADDRESS&gt;' /var/log/secure | awk '{print $1,$2,$3,$9,$11}'</code> ：查找特定 IP 失败的次数。</p>\n</li>\n<li>\n<p><code>sudo grep 'sshd.*Accepted.*from &lt;IP_ADDRESS&gt;' /var/log/secure | awk '{print $1,$2,$3,$9,$11}'</code> ：查找特定 IP 成功的次数。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><code>/var/log/cron</code> ：定时任务日志文件。</p>\n</li>\n<li>\n<p><code>/var/log/btmp</code> ：登录失败日志文件。</p>\n</li>\n<li>\n<p><code>/var/log/wtmp</code> ：登录记录日志文件。</p>\n</li>\n</ul>\n<h2 id=\"工具集\"><a class=\"anchor\" href=\"#工具集\">#</a> 工具集</h2>\n<ul>\n<li>\n<p><code>busybox</code> ：busybox 是一个包含多个常用 Linux 命令精简版本的工具集。它可以在嵌入式系统或资源受限的环境中使用，将多个命令集成到一个可执行文件中，以节省空间并提高效率。它可以作为替代系统中关键命令的解决方案，因为它是一个独立的可执行文件，不依赖于系统中的命令。</p>\n<ul>\n<li><code>./busybox netstat -antpl</code> ：使用 busybox 的 netstat 命令显示网络连接和监听端口的信息。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"隐藏进程检测工具\"><a class=\"anchor\" href=\"#隐藏进程检测工具\">#</a> 隐藏进程检测工具</h2>\n<ul>\n<li><code>unhide</code> ：用于探测隐藏进程的工具。</li>\n</ul>\n<h2 id=\"rootkit-检测工具\"><a class=\"anchor\" href=\"#rootkit-检测工具\">#</a> Rootkit 检测工具</h2>\n<ul>\n<li>\n<p><code>chkrootkit -n</code> ：用于探测 rootkit 的工具。 <code>-n</code>  选项表示以非交互模式运行。</p>\n</li>\n<li>\n<p><code>rkhunter</code> ：另一个用于探测 rootkit 的工具。</p>\n</li>\n</ul>\n<h2 id=\"恶意软件扫描工具\"><a class=\"anchor\" href=\"#恶意软件扫描工具\">#</a> 恶意软件扫描工具</h2>\n<ul>\n<li><code>clamav</code> ：用于扫描和检测恶意软件的工具。</li>\n</ul>\n<h2 id=\"webshell-查杀工具\"><a class=\"anchor\" href=\"#webshell-查杀工具\">#</a> Webshell 查杀工具</h2>\n<ul>\n<li><code>www.shellpub.com</code> ：河马 webshell 查杀工具。</li>\n</ul>\n<h2 id=\"内存马查杀工具\"><a class=\"anchor\" href=\"#内存马查杀工具\">#</a> 内存马查杀工具</h2>\n<ul>\n<li><code>java-memshell-scanner</code> ：用于查杀内存马（内存中的恶意代码）的工具。</li>\n</ul>\n",
            "tags": [
                "linux",
                "security",
                "hvv",
                "应急响应",
                "tools",
                "busybox",
                "ps"
            ]
        }
    ]
}