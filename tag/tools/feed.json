{
    "version": "https://jsonfeed.org/version/1",
    "title": "MAXshiro • All posts by \"tools\" tag",
    "description": "Discover and Record the world.",
    "home_page_url": "http://maxshiroi.top",
    "items": [
        {
            "id": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/002945/",
            "url": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/002945/",
            "title": "常用Windows应急响应整理",
            "date_published": "2023-07-02T16:29:45.000Z",
            "content_html": "<h1 id=\"windows相关\"><a class=\"anchor\" href=\"#windows相关\">#</a> Windows 相关</h1>\n<h2 id=\"常用程序\"><a class=\"anchor\" href=\"#常用程序\">#</a> 常用程序</h2>\n<blockquote>\n<p>小心被病毒整蛊，记住下面命令：</p>\n</blockquote>\n<ul>\n<li>\n<p><code>regedit</code> ：注册表编辑器，用于管理 Windows 系统的注册表，可以查看、编辑和修改注册表中的配置信息。</p>\n</li>\n<li>\n<p><code>Taskmgr</code> ：任务管理器，用于查看和管理系统中运行的进程、服务和性能监控等。</p>\n</li>\n<li>\n<p><code>msconfig</code> ：系统配置实用程序，用于管理 Windows 启动时的启动项、服务和引导选项，可以进行系统启动项的配置和管理。</p>\n</li>\n<li>\n<p><code>eventvwr.msc</code> ：事件查看器，用于查看和分析系统和应用程序生成的事件日志，帮助诊断和解决系统问题。</p>\n</li>\n<li>\n<p><code>compmgmt.msc</code> ：计算机管理控制台，提供了对计算机硬件、设备管理、本地用户和组管理、磁盘管理等的集中管理。</p>\n</li>\n<li>\n<p><code>gpedit.msc</code> ：组策略编辑器，用于管理 Windows 系统中的组策略，可以配置计算机和用户的策略设置。</p>\n</li>\n<li>\n<p><code>taskschd.msc</code> ：任务计划程序，用于创建和管理定时任务，可以设置计划运行的程序、脚本和操作等。</p>\n</li>\n<li>\n<p><code>lusrmgr.msc</code> ：本地用户和组管理器，用于管理本地计算机上的用户账户和用户组，可以创建、修改和删除用户账户和组。</p>\n</li>\n</ul>\n<h2 id=\"特别注意\"><a class=\"anchor\" href=\"#特别注意\">#</a> 特别注意</h2>\n<ol>\n<li>\n<p>获取本机用户列表<br>\n <code>net user</code></p>\n</li>\n<li>\n<p>管理员<br>\n <code>net localgroup administrators</code></p>\n</li>\n<li>\n<p>当前会话<br>\n <code>net session</code></p>\n</li>\n<li>\n<p>当前运行的服务<br>\n <code>net start</code></p>\n</li>\n<li>\n<p>远程连接<br>\n <code>net use</code></p>\n</li>\n<li>\n<p>当前用户共享目录<br>\n <code>net share</code></p>\n</li>\n<li>\n<p>最近打开文件</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%UserProfile%\\Recent</span><br><span class=\"line\">%APPDATA%\\Microsoft\\Windows\\Recent</span><br></pre></td></tr></tbody></table></figure>\n<ol start=\"8\">\n<li>查找文件中的字符串<br>\n <code>findstr /m /i /s \"hello\" *.txt</code></li>\n</ol>\n<h2 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h2>\n<blockquote>\n<p>这些命令可用于网络连接和进程管理，获取系统信息和补丁，以及计算文件的哈希值。你可以根据需要使用它们来进行系统管理、安全检查和文件验证。</p>\n</blockquote>\n<h3 id=\"网络相关命令\"><a class=\"anchor\" href=\"#网络相关命令\">#</a> 网络相关命令</h3>\n<ul>\n<li><code>netstat -ano</code> ：显示网络连接、监听端口和进程的详细信息，包括相关的进程 ID。</li>\n</ul>\n<h3 id=\"系统信息命令\"><a class=\"anchor\" href=\"#系统信息命令\">#</a> 系统信息命令</h3>\n<ul>\n<li><code>systeminfo</code> ：显示系统的详细信息，包括操作系统版本、补丁信息、硬件配置等。特别关注补丁信息，以确保系统的安全性。</li>\n</ul>\n<h3 id=\"进程管理命令\"><a class=\"anchor\" href=\"#进程管理命令\">#</a> 进程管理命令</h3>\n<ul>\n<li>\n<p><code>Wmic process</code> ：用于查询和管理系统中的进程。</p>\n<ul>\n<li>\n<p><code>Wmic process where name=\"cmd.exe\" get processid,executablepath,name</code> ：查询并显示名称为 \"cmd.exe\" 的进程的进程 ID、可执行路径和名称。</p>\n</li>\n<li>\n<p><code>Wmic process where processid=\"***\" get executablepath,name</code> ：查询并显示指定进程 ID 的进程的可执行路径和名称。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><code>tasklist /m ***.dll</code> ：显示指定 DLL 文件相关的进程列表。</p>\n</li>\n</ul>\n<h3 id=\"文件哈希计算命令\"><a class=\"anchor\" href=\"#文件哈希计算命令\">#</a> 文件哈希计算命令</h3>\n<ul>\n<li><code>certutil -hashfile %样本exe% MD5</code> ：计算指定样本文件（例如样本 exe）的 MD5 哈希值。</li>\n</ul>\n<h2 id=\"敏感目录\"><a class=\"anchor\" href=\"#敏感目录\">#</a> 敏感目录</h2>\n<blockquote>\n<p>这些敏感目录通常包含重要的系统文件、用户数据和应用程序配置文件。黑客或恶意软件可能会利用这些目录来隐藏恶意文件、执行攻击或获取敏感信息。因此，在网络安全中，对这些目录进行适当的保护和监控非常重要。</p>\n</blockquote>\n<ul>\n<li>\n<p><code>%WINDIR%</code> ：Windows 系统目录，通常为  <code>C:\\Windows</code> 。该目录包含了操作系统的核心文件和系统配置文件。</p>\n</li>\n<li>\n<p><code>%WINDIR%\\system32\\</code> ：Windows 系统目录下的  <code>system32</code>  子目录，通常为  <code>C:\\Windows\\system32</code> 。该目录包含了许多系统和应用程序的关键文件和库文件。</p>\n</li>\n<li>\n<p><code>%TEMP%</code> ：当前用户的临时文件夹路径。通常为  <code>C:\\Users\\用户名\\AppData\\Local\\Temp</code> 。临时文件夹用于存储临时文件和缓存文件。</p>\n</li>\n<li>\n<p><code>%LOCALAPPDATA%</code> ：当前用户的本地应用数据文件夹路径。通常为  <code>C:\\Users\\用户名\\AppData\\Local</code> 。该目录用于存储与用户相关的应用程序数据，如缓存文件、配置文件等。</p>\n</li>\n<li>\n<p><code>%APPDATA%</code> ：当前用户的应用数据文件夹路径。通常为  <code>C:\\Users\\用户名\\AppData\\Roaming</code> 。该目录用于存储应用程序的个人设置、配置文件和其他用户特定的数据。</p>\n</li>\n</ul>\n<h2 id=\"日志\"><a class=\"anchor\" href=\"#日志\">#</a> 日志</h2>\n<h3 id=\"事件查看器\"><a class=\"anchor\" href=\"#事件查看器\">#</a> 事件查看器</h3>\n<ul>\n<li><code>eventvwr</code> ：事件查看器，用于查看和分析系统和应用程序生成的事件日志。</li>\n</ul>\n<h3 id=\"事件日志路径\"><a class=\"anchor\" href=\"#事件日志路径\">#</a> 事件日志路径</h3>\n<ul>\n<li>\n<p><code>%SystemRoot%System32WinevtLogsSystem.evtx</code> ：系统日志文件路径，包含有关系统启动、关闭和其他系统级事件的信息。</p>\n</li>\n<li>\n<p><code>%SystemRoot%System32WinevtLogsSecurity.evtx</code> ：安全日志文件路径，包含有关安全相关事件的信息。</p>\n</li>\n</ul>\n<h3 id=\"系统启动关闭事件\"><a class=\"anchor\" href=\"#系统启动关闭事件\">#</a> 系统启动 / 关闭事件</h3>\n<ul>\n<li><code>系统启动/关闭 12/13</code> ：指示系统启动和关闭的事件计数。</li>\n</ul>\n<h3 id=\"事件日志服务启动关闭事件\"><a class=\"anchor\" href=\"#事件日志服务启动关闭事件\">#</a> 事件日志服务启动 / 关闭事件</h3>\n<ul>\n<li><code>事件日志服务启动/关闭 6005/6006</code> ：指示事件日志服务的启动和关闭事件计数。</li>\n</ul>\n<h3 id=\"常见事件id表\"><a class=\"anchor\" href=\"#常见事件id表\">#</a> 常见事件 ID 表：</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">事件 ID</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1102</td>\n<td style=\"text-align:center\">清理审计日志</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4624</td>\n<td style=\"text-align:center\">账号成功登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4625</td>\n<td style=\"text-align:center\">账号登录失败</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4768</td>\n<td style=\"text-align:center\">Kerberos 身份验证 (TGT 请求)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4769</td>\n<td style=\"text-align:center\">Kerberos 服务票证请求</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4776</td>\n<td style=\"text-align:center\">NTLM 身份验证</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4672</td>\n<td style=\"text-align:center\">授予特殊权限</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4720</td>\n<td style=\"text-align:center\">创建用户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4726</td>\n<td style=\"text-align:center\">删除用户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4728</td>\n<td style=\"text-align:center\">将成员添加到启用安全的全局组中</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4729</td>\n<td style=\"text-align:center\">将成员从安全的全局组中移除</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4732</td>\n<td style=\"text-align:center\">将成员添加到启用安全的本地组中</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4733</td>\n<td style=\"text-align:center\">将成员从启用安全的本地组中移除</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4756</td>\n<td style=\"text-align:center\">将成员添加到启用安全的通用组中</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4757</td>\n<td style=\"text-align:center\">将成员从启用安全的通用组中移除</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4719</td>\n<td style=\"text-align:center\">系统审计策略修改</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"常见-logontype-值\"><a class=\"anchor\" href=\"#常见-logontype-值\">#</a> 常见 LogonType 值</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">LogonType 值</th>\n<th style=\"text-align:center\">含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">交互式登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">网络登录（一般情况下就是永恒之蓝）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">批处理登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">服务登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">解锁</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">网络远程登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">9</td>\n<td style=\"text-align:center\">缓存的远程登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">10</td>\n<td style=\"text-align:center\">远程交互式登录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">...</td>\n<td style=\"text-align:center\">...</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"应急工具\"><a class=\"anchor\" href=\"#应急工具\">#</a> 应急工具</h2>\n<p>下面是一些应急工具的示例和相关信息：</p>\n<ul>\n<li>\n<p><strong>PChunter</strong>：Antirootkit 工具，用于检测和清除系统中的 rootkit（恶意软件）。</p>\n</li>\n<li>\n<p><strong>Autoruns</strong>：启动项管理工具，用于查看和管理系统启动时自动运行的程序、服务和驱动程序。</p>\n</li>\n<li>\n<p><strong>ProcessExplorer</strong>：进程查看工具，提供了比任务管理器更详细和全面的进程信息，包括进程的资源使用、文件关联等。</p>\n</li>\n<li>\n<p><strong>ProcessMonitor</strong>：进程监控工具，用于实时监视和记录系统上的进程活动、文件系统活动和注册表活动。</p>\n</li>\n<li>\n<p><strong>TCPView</strong>：网络连接查看工具，显示当前系统上的网络连接和相关的进程信息，可用于监视和分析网络连接。</p>\n</li>\n<li>\n<p><strong>Microsoft Network Monitor</strong>：网络监控工具，可用于捕获和分析网络数据包，提供详细的网络通信信息和相关的进程。</p>\n</li>\n<li>\n<p><strong>D 盾</strong>：Webshell 查杀工具，用于检测和清除 Web 服务器上的恶意 Webshell（恶意脚本）。</p>\n</li>\n<li>\n<p><strong>Everything</strong>：快速搜索工具，可以快速索引和搜索系统上的文件和文件夹。</p>\n</li>\n<li>\n<p><strong>BeaconEye</strong>：针对 Cobalt Strike（一种渗透测试工具）的特征检测工具。可在 GitHub 上找到该工具，地址为: <a href=\"https://github.com/CCob/BeaconEye\">CCob/BeaconEye</a>。</p>\n</li>\n</ul>\n<h2 id=\"威胁情报样本分析平台\"><a class=\"anchor\" href=\"#威胁情报样本分析平台\">#</a> 威胁情报 / 样本分析平台：</h2>\n<p>奇安信威胁情报中心<br>\n微步在线社区<br>\n Virus total<br>\nIBMXFORCE</p>\n<h2 id=\"sysmonsystem-monitor在事件查看器中查看\"><a class=\"anchor\" href=\"#sysmonsystem-monitor在事件查看器中查看\">#</a> Sysmon（System Monitor）（在事件查看器中查看）</h2>\n<p>Sysmon 可以监控并记录操作系统内核级别的事件，包括进程创建、文件创建、网络连接、注册表操作、服务启动、驱动加载等等。这些事件的详细信息被记录在 Windows 事件日志中，可以通过事件查看器或其他日志分析工具进行检索和分析。</p>\n<table>\n<thead>\n<tr>\n<th>事件 ID</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>进程创建</td>\n</tr>\n<tr>\n<td>3</td>\n<td>网络连接</td>\n</tr>\n<tr>\n<td>11</td>\n<td>文件创建</td>\n</tr>\n<tr>\n<td>22</td>\n<td>记录 DNS 查询</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"内存取证\"><a class=\"anchor\" href=\"#内存取证\">#</a> 内存取证</h2>\n<p>Dumplt / FTK imager / WinPMem</p>\n<h3 id=\"分析\"><a class=\"anchor\" href=\"#分析\">#</a> 分析</h3>\n<p>Volatility (github: volatilityfoundation/volatility)<br>\n volatility -f [内存文件] --profile=[配置文件] &lt; 插件 &gt; # 不同版本有不同的配置文件</p>\n<h1 id=\"案例\"><a class=\"anchor\" href=\"#案例\">#</a> 案例</h1>\n",
            "tags": [
                "应急响应",
                "hvv",
                "tools",
                "windows"
            ]
        },
        {
            "id": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/215254/",
            "url": "http://maxshiroi.top/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/215254/",
            "title": "常用linux应急响应命令整理",
            "date_published": "2023-07-02T13:52:54.000Z",
            "content_html": "<h2 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h2>\n<h3 id=\"ps-auxf\"><a class=\"anchor\" href=\"#ps-auxf\">#</a> ps -auxf</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -auxf</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于显示系统中当前运行的进程。 <code>-a</code>  选项显示所有用户的进程， <code>-u</code>  选项显示进程的详细信息， <code>-x</code>  选项显示没有控制终端的进程， <code>-f</code>  选项以全格式显示进程信息。</p>\n<h3 id=\"netstat-antlp-more\"><a class=\"anchor\" href=\"#netstat-antlp-more\">#</a> netstat -antlp | more</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -antlp | more</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看系统中的网络连接和监听端口。 <code>-a</code>  选项显示所有连接和监听端口， <code>-n</code>  选项以数字形式显示地址和端口， <code>-t</code>  选项只显示 TCP 连接， <code>-l</code>  选项只显示监听端口， <code>-p</code>  选项显示与进程关联的端口， <code>| more</code>  用于分页显示输出结果。</p>\n<h3 id=\"ls-alt-procpid号\"><a class=\"anchor\" href=\"#ls-alt-procpid号\">#</a> ls -alt /proc/pid 号</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alt /proc/pid号</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定进程的详细信息。 <code>ls</code>  命令用于列出文件和目录， <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-t</code>  选项按修改时间排序， <code>/proc</code>  是一个特殊目录，包含系统中运行的进程的信息， <code>pid号</code> 是要查看的进程的进程 ID。</p>\n<h3 id=\"ls-alh-procpid\"><a class=\"anchor\" href=\"#ls-alh-procpid\">#</a> ls -alh /proc/pid</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alh /proc/pid</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定进程的详细信息。 <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-h</code>  选项以人类可读的方式显示文件大小， <code>/proc</code>  是一个特殊目录，包含系统中运行的进程的信息， <code>pid</code>  是要查看的进程的进程 ID。</p>\n<h3 id=\"lsof-i端口号-p-u\"><a class=\"anchor\" href=\"#lsof-i端口号-p-u\">#</a> lsof -i: 端口号 /-p/-u</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lsof -i:端口号 /-p /-u</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看指定端口的相关进程或指定用户打开的文件。 <code>lsof</code>  命令用于列出打开的文件， <code>-i:端口号</code> 选项显示指定端口相关的进程， <code>/-p</code>  选项显示指定进程打开的文件， <code>/-u</code>  选项显示指定用户打开的文件。</p>\n<h3 id=\"挖矿病毒常利用手段\"><a class=\"anchor\" href=\"#挖矿病毒常利用手段\">#</a> 挖矿病毒常利用手段</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chattr +i</span><br><span class=\"line\">lsattr</span><br></pre></td></tr></tbody></table></figure>\n<ul>\n<li>\n<p><code>chattr +i</code> ：此命令用于改变文件的属性。 <code>chattr</code>  命令用于改变文件的扩展属性， <code>+i</code>  选项设置文件为不可修改属性，防止文件被删除、重命名或修改。</p>\n</li>\n<li>\n<p><code>lsattr</code> ：此命令用于显示文件的扩展属性。 <code>lsattr</code>  命令用于</p>\n</li>\n</ul>\n<p>列出文件的扩展属性，包括文件的可修改性、不可修改性、是否加密等。</p>\n<h3 id=\"需要注意的几个目录\"><a class=\"anchor\" href=\"#需要注意的几个目录\">#</a> 需要注意的几个目录</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/passwd</span><br><span class=\"line\">/etc/rc.local</span><br><span class=\"line\">/root/.ssh</span><br><span class=\"line\">/tmp</span><br><span class=\"line\">/etc/init.d</span><br><span class=\"line\">/etc/hosts</span><br></pre></td></tr></tbody></table></figure>\n<p>此路径对应着系统启动时执行的脚本文件。 <code>/etc/rc.local</code>  文件包含在系统启动过程中自动执行的命令，可以用于配置系统启动时需要运行的自定义脚本。</p>\n<h3 id=\"ls-alt-etcprofiledsh\"><a class=\"anchor\" href=\"#ls-alt-etcprofiledsh\">#</a> ls -alt /etc/profile.d/*.sh</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -alt /etc/profile.d/*.sh</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于列出 <code>/etc/profile.d/</code>  目录下以 <code>.sh</code>  为后缀的脚本文件，并按照修改时间排序显示详细信息。 <code>ls</code>  命令用于列出文件和目录， <code>-a</code>  选项显示所有文件和目录（包括隐藏文件）， <code>-l</code>  选项以长格式显示详细信息， <code>-t</code>  选项按修改时间排序， <code>/etc/profile.d/*.sh</code>  表示匹配 <code>/etc/profile.d/</code>  目录下以 <code>.sh</code>  为后缀的所有文件。</p>\n<h3 id=\"cat-etcpasswd-cut-f-1-d-xargs-l-crontab-l-u\"><a class=\"anchor\" href=\"#cat-etcpasswd-cut-f-1-d-xargs-l-crontab-l-u\">#</a> cat /etc/passwd | cut -f 1 -d : | xargs -l {} crontab -l -u {}</h3>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/passwd | cut -f 1 -d : | xargs -l {} crontab -l -u {}</span><br></pre></td></tr></tbody></table></figure>\n<p>此命令用于查看系统中所有用户的定时任务。 <code>cat</code>  命令用于显示文件内容， <code>/etc/passwd</code>  是一个包含系统用户信息的文件， <code>cut</code>  命令用于提取指定字段， <code>-f 1</code>  选项指定提取第一个字段（用户名）， <code>-d :</code>  选项指定字段的分隔符为冒号， <code>xargs</code>  命令用于将前面的输出作为参数传递给后面的命令， <code>-l</code>  选项表示逐行处理， <code>{}</code>  表示参数的占位符， <code>crontab -l -u {}</code>  用于查看指定用户的定时任务列表。</p>\n<h2 id=\"软件包校验\"><a class=\"anchor\" href=\"#软件包校验\">#</a> 软件包校验</h2>\n<ul>\n<li>\n<p><code>rpm -Va</code> ：校验 RPM 软件包的完整性和一致性。如果输出中出现以下标记，表示不一致：s (size)、m (modify)、5 (MD5)、d (device)、l (link)、u (user)、g (group)、t (time)。特别需要注意的是 SM5 标记。</p>\n</li>\n<li>\n<p><code>dpkg -verify</code> ：校验 Debian 软件包的完整性和一致性。</p>\n</li>\n</ul>\n<h2 id=\"文件操作\"><a class=\"anchor\" href=\"#文件操作\">#</a> 文件操作</h2>\n<ul>\n<li>\n<p><code>stat</code> ：显示文件或文件系统的详细信息。</p>\n</li>\n<li>\n<p><code>find / -mtime 0 -name *.*</code> ：查找指定天数内更改过的文件。</p>\n</li>\n<li>\n<p><code>find / -ctime 0 -name *.*</code> ：查找新增的文件。</p>\n</li>\n<li>\n<p><code>diff -c</code> ：比较文件的差异并生成上下文格式的差异。</p>\n</li>\n</ul>\n<h2 id=\"查找隐藏进程\"><a class=\"anchor\" href=\"#查找隐藏进程\">#</a> 查找隐藏进程</h2>\n<ul>\n<li>\n<pre><code>ps -ef | awk '{print $2}' | sort -n | uniq &gt; ps.p\nls /proc | sort -n | uniq &gt; proc.p\n</code></pre>\n<p>查找隐藏进程的命令。</p>\n</li>\n</ul>\n<h2 id=\"ssh-爆破\"><a class=\"anchor\" href=\"#ssh-爆破\">#</a> SSH 爆破</h2>\n<ul>\n<li><code>last/lastb/lastlog</code> ：查看登录记录。</li>\n</ul>\n<h2 id=\"日志\"><a class=\"anchor\" href=\"#日志\">#</a> 日志</h2>\n<ul>\n<li>\n<p><code>/var/log/secure</code> ：安全日志文件。</p>\n<ul>\n<li>\n<p><code>awk '/sshd.*Failed/{print $(NF -3)}' /var/log/secure | sort | uniq -c | sort -nr</code> ：查找每个 IP 登录失败的次数。</p>\n</li>\n<li>\n<p>每条记录的格式：时间 - 主机名 - 服务名称 - 是否成功 - 用户 - 地址</p>\n</li>\n<li>\n<p><code>sudo grep 'sshd.*Failed.*from &lt;IP_ADDRESS&gt;' /var/log/secure | awk '{print $1,$2,$3,$9,$11}'</code> ：查找特定 IP 失败的次数。</p>\n</li>\n<li>\n<p><code>sudo grep 'sshd.*Accepted.*from &lt;IP_ADDRESS&gt;' /var/log/secure | awk '{print $1,$2,$3,$9,$11}'</code> ：查找特定 IP 成功的次数。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><code>/var/log/cron</code> ：定时任务日志文件。</p>\n</li>\n<li>\n<p><code>/var/log/btmp</code> ：登录失败日志文件。</p>\n</li>\n<li>\n<p><code>/var/log/wtmp</code> ：登录记录日志文件。</p>\n</li>\n</ul>\n<h2 id=\"工具集\"><a class=\"anchor\" href=\"#工具集\">#</a> 工具集</h2>\n<ul>\n<li>\n<p><code>busybox</code> ：busybox 是一个包含多个常用 Linux 命令精简版本的工具集。它可以在嵌入式系统或资源受限的环境中使用，将多个命令集成到一个可执行文件中，以节省空间并提高效率。它可以作为替代系统中关键命令的解决方案，因为它是一个独立的可执行文件，不依赖于系统中的命令。</p>\n<ul>\n<li><code>./busybox netstat -antpl</code> ：使用 busybox 的 netstat 命令显示网络连接和监听端口的信息。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"隐藏进程检测工具\"><a class=\"anchor\" href=\"#隐藏进程检测工具\">#</a> 隐藏进程检测工具</h2>\n<ul>\n<li><code>unhide</code> ：用于探测隐藏进程的工具。</li>\n</ul>\n<h2 id=\"rootkit-检测工具\"><a class=\"anchor\" href=\"#rootkit-检测工具\">#</a> Rootkit 检测工具</h2>\n<ul>\n<li>\n<p><code>chkrootkit -n</code> ：用于探测 rootkit 的工具。 <code>-n</code>  选项表示以非交互模式运行。</p>\n</li>\n<li>\n<p><code>rkhunter</code> ：另一个用于探测 rootkit 的工具。</p>\n</li>\n</ul>\n<h2 id=\"恶意软件扫描工具\"><a class=\"anchor\" href=\"#恶意软件扫描工具\">#</a> 恶意软件扫描工具</h2>\n<ul>\n<li><code>clamav</code> ：用于扫描和检测恶意软件的工具。</li>\n</ul>\n<h2 id=\"webshell-查杀工具\"><a class=\"anchor\" href=\"#webshell-查杀工具\">#</a> Webshell 查杀工具</h2>\n<ul>\n<li><code>www.shellpub.com</code> ：河马 webshell 查杀工具。</li>\n</ul>\n<h2 id=\"内存马查杀工具\"><a class=\"anchor\" href=\"#内存马查杀工具\">#</a> 内存马查杀工具</h2>\n<ul>\n<li><code>java-memshell-scanner</code> ：用于查杀内存马（内存中的恶意代码）的工具。</li>\n</ul>\n",
            "tags": [
                "linux",
                "security",
                "应急响应",
                "hvv",
                "tools",
                "busybox",
                "ps"
            ]
        }
    ]
}